"pack_years_smoked", "years_smoked")], as.integer)
clinical_cleaned[c("age_at_diagnosis", "days_to_death",
"ciagrettes_per_day",
"exposure_duration_years",
"pack_years_smoked", "years_smoked")] <- lapply(clinical_cleaned[c("age_at_diagnosis", "days_to_death",
"cigarettes_per_day",
"exposure_duration_years",
"pack_years_smoked", "years_smoked")], as.integer)
str(clinical_cleaned)
View(clinical)
View(clinical_cleaned)
clinical_cleaned <- merge(clinical, exposure, by = "case_id", all.x = TRUE, all.y = TRUE)
# Clinical cleaning
## filter columns in clinical df
clinical_cleaned = subset(clinical_cleaned, select = c(case_id,
ethnicity,
gender,
race,
vital_status,
age_at_diagnosis,
days_to_death,
ajcc_pathologic_stage,
primary_diagnosis,
treatment_type,
cigarettes_per_day,
exposure_duration_years,
exposure_type,
pack_years_smoked,
tobacco_smoking_status,
years_smoked))
## Convert columns to int
clinical_cleaned[c("age_at_diagnosis", "days_to_death",
"ciagrettes_per_day",
"exposure_duration_years",
"pack_years_smoked", "years_smoked")] <- lapply(clinical_cleaned[c("age_at_diagnosis", "days_to_death",
"cigarettes_per_day",
"exposure_duration_years",
"pack_years_smoked", "years_smoked")], as.integer)
View(clinical_cleaned)
View(exposure)
clinical <- read.table("Data/clinical.tsv", header = TRUE, sep = "\t", fill = TRUE, quote = "")
exposure <- read.table("Data/exposure.tsv", header = TRUE, sep = "\t", fill = TRUE, quote = "")
mutation <- read.table("Data/frequent-mutations.2024-03-18.tsv", header = TRUE, sep = "\t", fill = TRUE, quote = "")
genes <- read.table("Data/frequently-mutated-genes.2024-03-18.tsv", header = TRUE, sep = "\t", fill = TRUE, quote = "")
# Convert empty values to NA and remove empty columns
data_frames <- list(clinical = clinical,
exposure = exposure,
mutation = mutation,
genes = genes)
replace_dash_with_NA <- function(df) {
df[df == "'--"] <- NA
df <- df[, colSums(is.na(df)) < nrow(df)]
return(df)
}
modified_data_frames <- lapply(data_frames, replace_dash_with_NA)
list2env(modified_data_frames, envir = .GlobalEnv)
# combine clinical and exposure based on case id
clinical_cleaned <- merge(clinical, exposure, by = "case_id", all.x = TRUE, all.y = TRUE)
# Clinical cleaning
## filter columns in clinical df
clinical_cleaned = subset(clinical_cleaned, select = c(case_id,
ethnicity,
gender,
race,
vital_status,
age_at_diagnosis,
days_to_death,
ajcc_pathologic_stage,
primary_diagnosis,
treatment_type,
cigarettes_per_day,
exposure_duration_years,
exposure_type,
pack_years_smoked,
tobacco_smoking_status,
years_smoked))
## Convert columns to int
clinical_cleaned[c("age_at_diagnosis", "days_to_death",
"ciagrettes_per_day",
"exposure_duration_years",
"pack_years_smoked", "years_smoked")] <- lapply(clinical_cleaned[c("age_at_diagnosis", "days_to_death",
"cigarettes_per_day",
"exposure_duration_years",
"pack_years_smoked", "years_smoked")], as.integer)
View(clinical_cleaned)
clinical_cleaned = subset(clinical_cleaned, select = c(case_id,
ethnicity,
gender,
race,
vital_status,
age_at_diagnosis,
days_to_death,
ajcc_pathologic_stage,
primary_diagnosis,
treatment_type,
cigarettes_per_day,
exposure_duration_years,
exposure_type,
pack_years_smoked,
tobacco_smoking_status,
years_smoked))
clinical_cleaned[c("age_at_diagnosis", "days_to_death",
"cigarettes_per_day",
"exposure_duration_years",
"pack_years_smoked", "years_smoked")] <- lapply(clinical_cleaned[c("age_at_diagnosis", "days_to_death",
"cigarettes_per_day",
"exposure_duration_years",
"pack_years_smoked", "years_smoked")], as.integer)
View(clinical_cleaned)
View(exposure)
clinical_cleaned[c("age_at_diagnosis", "days_to_death",
"cigarettes_per_day",
"exposure_duration_years",
"pack_years_smoked", "years_smoked")] <- lapply(clinical_cleaned[c("age_at_diagnosis", "days_to_death",
"cigarettes_per_day",
"exposure_duration_years",
"pack_years_smoked", "years_smoked")], as.numeric)
View(clinical_cleaned)
clinical <- read.table("Data/clinical.tsv", header = TRUE, sep = "\t", fill = TRUE, quote = "")
exposure <- read.table("Data/exposure.tsv", header = TRUE, sep = "\t", fill = TRUE, quote = "")
mutation <- read.table("Data/frequent-mutations.2024-03-18.tsv", header = TRUE, sep = "\t", fill = TRUE, quote = "")
genes <- read.table("Data/frequently-mutated-genes.2024-03-18.tsv", header = TRUE, sep = "\t", fill = TRUE, quote = "")
# Convert empty values to NA and remove empty columns
data_frames <- list(clinical = clinical,
exposure = exposure,
mutation = mutation,
genes = genes)
replace_dash_with_NA <- function(df) {
df[df == "'--"] <- NA
df <- df[, colSums(is.na(df)) < nrow(df)]
return(df)
}
modified_data_frames <- lapply(data_frames, replace_dash_with_NA)
list2env(modified_data_frames, envir = .GlobalEnv)
# combine clinical and exposure based on case id
clinical_cleaned <- merge(clinical, exposure, by = "case_id", all.x = TRUE, all.y = TRUE)
# Clinical cleaning
## filter columns in clinical df
clinical_cleaned = subset(clinical_cleaned, select = c(case_id,
ethnicity,
gender,
race,
vital_status,
age_at_diagnosis,
days_to_death,
ajcc_pathologic_stage,
primary_diagnosis,
treatment_type,
cigarettes_per_day,
exposure_duration_years,
exposure_type,
pack_years_smoked,
tobacco_smoking_status,
years_smoked))
## Convert columns to numeric
clinical_cleaned[c("age_at_diagnosis", "days_to_death",
"cigarettes_per_day",
"exposure_duration_years",
"pack_years_smoked", "years_smoked")] <- lapply(clinical_cleaned[c("age_at_diagnosis", "days_to_death",
"cigarettes_per_day",
"exposure_duration_years",
"pack_years_smoked", "years_smoked")], as.numeric)
## Convert to days to years
clinical_cleaned$age_at_diagnosis <- ifelse(clinical_cleaned$age_at_diagnosis > 150,
clinical_cleaned$age_at_diagnosis / 365,
round(clinical_cleaned$age_at_diagnosis, digits = 2))
str(clinical_cleaned)
## Calculate age at death
clinical_cleaned <- clinical_cleaned %>% mutate(age_at_death = age_at_diagnosis + days_to_death/365)
clinical_cleaned <- clinical_cleaned %>% relocate(age_at_death, .after = age_at_diagnosis)
View(clinical_cleaned)
## Remove rows that don't have vital_status
clinical_cleaned <- subset(clinical_cleaned, !is.na(vital_status))
View(clinical_cleaned)
clinical_table <- apply(subset(clinical_cleaned, select = -c(case_id,
age_at_diagnosis,
age_at_death,
days_to_death,
cigarettes_per_day,
exposure_duration_years,
pack_years_smoked,
years_smoked)),2,table)
print(clinical_table)
clinical_stats <- describe(subset(clinical_cleaned, select = c(age_at_diagnosis,
age_at_death,
days_to_death,
cigarettes_per_day,
exposure_duration_years,
pack_years_smoked,
years_smoked)))
print(clinical_stats)
View(exposure)
View(clinical_cleaned)
# Create smoker and non smoker subsets
clincial_cleaned$smoker
# Create smoker and non smoker subsets
clincial_cleaned$smoker <- 0
clinical_cleaned <- clinical_cleaned %>% relocate(age_at_death, .after = age_at_diagnosis)
<- 0
clinical_cleaned$smoker
View(clinical_cleaned)
# Create smoker and non smoker subsets
clinical_cleaned$smoker <- 0
clinical_cleaned <- clinical_cleaned %>% relocate(smoker, .before = cigarettes_per_day)
View(clinical_cleaned)
clinical_cleaned$smoker <- ifelse(clinical_cleaned$cigarettes_per_day > 0,
clinical_cleaned$smoker =1)
clinical_cleaned$smoker <- ifelse(clinical_cleaned$cigarettes_per_day > 0, 1, 0)
View(clinical_cleaned)
clinical_stats <- describe(subset(clinical_cleaned, select = c(age_at_diagnosis,
age_at_death,
days_to_death,
smoker,
cigarettes_per_day,
exposure_duration_years,
pack_years_smoked,
years_smoked)))
print(clinical_stats)
clinical_cleaned$smoker <- ifelse(clinical_cleaned$cigarettes_per_day > 0, 1, NA_integer_)
View(clinical_cleaned)
clinical_cleaned$smoker[is.na(clinical_cleaned$smoker)] <- 0
View(clinical_cleaned)
# Import TSV files
clinical <- read.table("Data/clinical.tsv", header = TRUE, sep = "\t", fill = TRUE, quote = "")
exposure <- read.table("Data/exposure.tsv", header = TRUE, sep = "\t", fill = TRUE, quote = "")
mutation <- read.table("Data/frequent-mutations.2024-03-18.tsv", header = TRUE, sep = "\t", fill = TRUE, quote = "")
genes <- read.table("Data/frequently-mutated-genes.2024-03-18.tsv", header = TRUE, sep = "\t", fill = TRUE, quote = "")
# Convert empty values to NA and remove empty columns
data_frames <- list(clinical = clinical,
exposure = exposure,
mutation = mutation,
genes = genes)
replace_dash_with_NA <- function(df) {
df[df == "'--"] <- NA
df <- df[, colSums(is.na(df)) < nrow(df)]
return(df)
}
modified_data_frames <- lapply(data_frames, replace_dash_with_NA)
list2env(modified_data_frames, envir = .GlobalEnv)
# remove irrelevant rows from exposure
exposure <- subset(exposure, !is.na(cigarettes_per_day))
# combine clinical and exposure based on case id
clinical_cleaned <- merge(clinical, exposure, by = "case_id", all.x = TRUE, all.y = TRUE)
# Clinical cleaning
## filter columns in clinical df
clinical_cleaned = subset(clinical_cleaned, select = c(case_id,
ethnicity,
gender,
race,
vital_status,
age_at_diagnosis,
days_to_death,
ajcc_pathologic_stage,
primary_diagnosis,
treatment_type,
cigarettes_per_day,
exposure_duration_years,
exposure_type,
pack_years_smoked,
tobacco_smoking_status,
years_smoked))
## Convert columns to numeric
clinical_cleaned[c("age_at_diagnosis", "days_to_death",
"cigarettes_per_day",
"exposure_duration_years",
"pack_years_smoked", "years_smoked")] <- lapply(clinical_cleaned[c("age_at_diagnosis", "days_to_death",
"cigarettes_per_day",
"exposure_duration_years",
"pack_years_smoked", "years_smoked")], as.numeric)
## Convert to days to years
clinical_cleaned$age_at_diagnosis <- ifelse(clinical_cleaned$age_at_diagnosis > 150,
clinical_cleaned$age_at_diagnosis / 365,
round(clinical_cleaned$age_at_diagnosis, digits = 2))
## Remove rows that don't have vital_status
clinical_cleaned <- subset(clinical_cleaned, !is.na(vital_status))
## Calculate age at death
clinical_cleaned <- clinical_cleaned %>% mutate(age_at_death = age_at_diagnosis + days_to_death/365)
clinical_cleaned <- clinical_cleaned %>% relocate(age_at_death, .after = age_at_diagnosis)
# Create smoker and non smoker subsets
clinical_cleaned$smoker <- 0
clinical_cleaned <- clinical_cleaned %>% relocate(smoker, .before = cigarettes_per_day)
clinical_cleaned$smoker[is.na(clinical_cleaned$smoker)] <- 0
clinical_cleaned$smoker <- ifelse(clinical_cleaned$cigarettes_per_day > 0, 1, 0)
View(clinical_cleaned)
clinical_cleaned$smoker[is.na(clinical_cleaned$smoker)] <- 0
View(clinical_cleaned)
# Create smoker and non smoker subsets
clinical_cleaned$smoker <- NA
View(clinical_cleaned)
# Create smoker and non smoker subsets
clinical_cleaned$smoker <- 0
View(clinical_cleaned)
clinical_cleaned$smoker <- ifelse(clinical_cleaned$cigarettes_per_day > 0, 1, 0)
View(clinical_cleaned)
# Create smoker and non smoker subsets
clinical_cleaned$smoker <- 0
clinical_cleaned$smoker <- ifelse(is.na(clinical_cleaned$cigarettes_per_day) | clinical_cleaned$cigarettes_per_day > 0, 1, 0)
View(clinical_cleaned)
# Create smoker and non smoker subsets
clinical_cleaned$smoker <- 0
clinical_cleaned$smoker <- ifelse(is.na(clinical_cleaned$cigarettes_per_day),0)
clinical_cleaned$smoker <- ifelse(is.na(clinical_cleaned$cigarettes_per_day),0,0,0)
# Create smoker and non smoker subsets
clinical_cleaned$smoker <- 0
clinical_cleaned$smoker <- ifelse(!is.na(clinical_cleaned$cigarettes_per_day) & clinical_cleaned$cigarettes_per_day > 0, 1, 0)
View(clinical_cleaned)
# Create smoker and non smoker subsets
clinical_cleaned$smoker <- "No"
View(clinical_cleaned)
clinical_cleaned$smoker <- ifelse(!is.na(clinical_cleaned$cigarettes_per_day) & clinical_cleaned$cigarettes_per_day > 0, "Yes", 0)
View(clinical_cleaned)
# Create smoker and non smoker subsets
clinical_cleaned$smoker <- NA
clinical_cleaned$smoker <- ifelse(!is.na(clinical_cleaned$cigarettes_per_day) & clinical_cleaned$cigarettes_per_day > 0, "Yes", "No")
View(clinical_cleaned)
clinical_stats <- describe(subset(clinical_cleaned, select = c(age_at_diagnosis,
age_at_death,
days_to_death,
cigarettes_per_day,
exposure_duration_years,
pack_years_smoked,
years_smoked)))
clinical_table <- apply(subset(clinical_cleaned, select = -c(case_id,
age_at_diagnosis,
age_at_death,
days_to_death,
smoker,
cigarettes_per_day,
exposure_duration_years,
pack_years_smoked,
years_smoked)),2,table)
print(clinical_table)
clinical_table <- apply(subset(clinical_cleaned, select = -c(case_id,
age_at_diagnosis,
age_at_death,
days_to_death,
cigarettes_per_day,
exposure_duration_years,
pack_years_smoked,
years_smoked)),2,table)
print(clinical_table)
View(clinical_cleaned)
clinical_cleaned = subset(clinical_cleaned, select = c(case_id,
ethnicity,
gender,
race,
vital_status,
age_at_diagnosis,
days_to_death,
ajcc_pathologic_stage,
primary_diagnosis,
treatment_type,
cigarettes_per_day,
pack_years_smoked,
tobacco_smoking_status,
years_smoked))
View(clinical_cleaned)
clinical_stats <- describe(subset(clinical_cleaned, select = c(age_at_diagnosis,
age_at_death,
days_to_death,
cigarettes_per_day,
pack_years_smoked,
years_smoked)))
clinical_cleaned = subset(clinical_cleaned, select = c(case_id,
ethnicity,
gender,
race,
vital_status,
age_at_diagnosis,
days_to_death,
ajcc_pathologic_stage,
primary_diagnosis,
treatment_type,
cigarettes_per_day,
pack_years_smoked,
tobacco_smoking_status,
years_smoked))
## Convert columns to numeric
clinical_cleaned[c("age_at_diagnosis", "days_to_death",
"cigarettes_per_day",
"exposure_duration_years",
"pack_years_smoked", "years_smoked")] <- lapply(clinical_cleaned[c("age_at_diagnosis", "days_to_death",
"cigarettes_per_day",
"exposure_duration_years",
"pack_years_smoked", "years_smoked")], as.numeric)
## Convert columns to numeric
clinical_cleaned[c("age_at_diagnosis", "days_to_death",
"cigarettes_per_day",
"pack_years_smoked",
"years_smoked")] <- lapply(clinical_cleaned[c("age_at_diagnosis", "days_to_death",
"cigarettes_per_day",
"pack_years_smoked",
"years_smoked")], as.numeric)
## Convert to days to years
clinical_cleaned$age_at_diagnosis <- ifelse(clinical_cleaned$age_at_diagnosis > 150,
clinical_cleaned$age_at_diagnosis / 365,
round(clinical_cleaned$age_at_diagnosis, digits = 2))
## Remove rows that don't have vital_status
clinical_cleaned <- subset(clinical_cleaned, !is.na(vital_status))
## Calculate age at death
clinical_cleaned <- clinical_cleaned %>% mutate(age_at_death = age_at_diagnosis + days_to_death/365)
clinical_cleaned <- clinical_cleaned %>% relocate(age_at_death, .after = age_at_diagnosis)
# Create smoker and non smoker subsets
clinical_cleaned$smoker <- NA
clinical_cleaned$smoker <- ifelse(!is.na(clinical_cleaned$cigarettes_per_day) & clinical_cleaned$cigarettes_per_day > 0, "Yes", "No")
clinical_cleaned <- clinical_cleaned %>% relocate(smoker, .before = cigarettes_per_day)
View(clinical_cleaned)
# Clinical cleaning
## filter columns in clinical df
clinical_cleaned = subset(clinical_cleaned, select = c(case_id,
ethnicity,
gender,
race,
vital_status,
age_at_diagnosis,
days_to_death,
ajcc_pathologic_stage,
primary_diagnosis,
treatment_type,
cigarettes_per_day,
pack_years_smoked,
tobacco_smoking_status))
## Convert columns to numeric
clinical_cleaned[c("age_at_diagnosis", "days_to_death",
"cigarettes_per_day",
"pack_years_smoked")] <- lapply(clinical_cleaned[c("age_at_diagnosis", "days_to_death",
"cigarettes_per_day",
"pack_years_smoked")], as.numeric)
## Convert to days to years
clinical_cleaned$age_at_diagnosis <- ifelse(clinical_cleaned$age_at_diagnosis > 150,
clinical_cleaned$age_at_diagnosis / 365,
round(clinical_cleaned$age_at_diagnosis, digits = 2))
## Remove rows that don't have vital_status
clinical_cleaned <- subset(clinical_cleaned, !is.na(vital_status))
## Calculate age at death
clinical_cleaned <- clinical_cleaned %>% mutate(age_at_death = age_at_diagnosis + days_to_death/365)
clinical_cleaned <- clinical_cleaned %>% relocate(age_at_death, .after = age_at_diagnosis)
# Create smoker and non smoker subsets
clinical_cleaned$smoker <- NA
clinical_cleaned$smoker <- ifelse(!is.na(clinical_cleaned$cigarettes_per_day) & clinical_cleaned$cigarettes_per_day > 0, "Yes", "No")
clinical_cleaned <- clinical_cleaned %>% relocate(smoker, .before = cigarettes_per_day)
View(clinical_cleaned)
clinical_table <- apply(subset(clinical_cleaned, select = -c(case_id,
age_at_diagnosis,
age_at_death,
days_to_death,
cigarettes_per_day,
exposure_duration_years,
pack_years_smoked)),2,table)
## Clinical_cleaned categorical descriptive statistics
clinical_table <- apply(subset(clinical_cleaned, select = -c(case_id,
age_at_diagnosis,
age_at_death,
days_to_death,
cigarettes_per_day,
pack_years_smoked)),2,table)
print(clinical_table)
clinical_cleaned = subset(clinical_cleaned, select = c(case_id,
ethnicity,
gender,
race,
vital_status,
age_at_diagnosis,
days_to_death,
ajcc_pathologic_stage,
primary_diagnosis,
treatment_type,
cigarettes_per_day,
pack_years_smoked))
## Convert columns to numeric
clinical_cleaned[c("age_at_diagnosis", "days_to_death",
"cigarettes_per_day",
"pack_years_smoked")] <- lapply(clinical_cleaned[c("age_at_diagnosis", "days_to_death",
"cigarettes_per_day",
"pack_years_smoked")], as.numeric)
## Convert to days to years
clinical_cleaned$age_at_diagnosis <- ifelse(clinical_cleaned$age_at_diagnosis > 150,
clinical_cleaned$age_at_diagnosis / 365,
round(clinical_cleaned$age_at_diagnosis, digits = 2))
## Remove rows that don't have vital_status
clinical_cleaned <- subset(clinical_cleaned, !is.na(vital_status))
## Calculate age at death
clinical_cleaned <- clinical_cleaned %>% mutate(age_at_death = age_at_diagnosis + days_to_death/365)
clinical_cleaned <- clinical_cleaned %>% relocate(age_at_death, .after = age_at_diagnosis)
# Create smoker and non smoker subsets
clinical_cleaned$smoker <- NA
clinical_cleaned$smoker <- ifelse(!is.na(clinical_cleaned$cigarettes_per_day) & clinical_cleaned$cigarettes_per_day > 0, "Yes", "No")
clinical_cleaned <- clinical_cleaned %>% relocate(smoker, .before = cigarettes_per_day)
# Gene cleaning
## Remove unnecessary columns from genes
gene_cleaned <- subset(genes, select = -c(num_gdc_ssm_affected_cases,
num_gdc_ssm_cases,
gdc_ssm_affected_cases_percentage,
annotations))
# Descriptive statistics
##https://uc-r.github.io/descriptives_categorical
#https://cran.r-project.org/web/packages/finalfit/vignettes/export.html
## Clinical_cleaned categorical descriptive statistics
clinical_table <- apply(subset(clinical_cleaned, select = -c(case_id,
age_at_diagnosis,
age_at_death,
days_to_death,
cigarettes_per_day,
pack_years_smoked)),2,table)
print(clinical_table)
## clinical continuous descriptive statistics
clinical_stats <- describe(subset(clinical_cleaned, select = c(age_at_diagnosis,
age_at_death,
days_to_death,
cigarettes_per_day,
pack_years_smoked)))
print(clinical_stats)
